<div class="w-full group/section relative">

  <h2 class="text-center text-2xl font-bold tracking-tight text-gray-900 mb-8 uppercase">
    {{ title() }}
  </h2>

  @if (eventsResource.error()) {
    <componense-error-event-carousel
     (retry)="eventsResource.reload()"
    />
  }
  <!-- -->
  @else {
    <div class="relative min-h-[250px]">

      <button
        [hidden]="eventsResource.isLoading()"
        (click)="scrollLeft()"
        class="absolute left-0 top-1/2 -translate-y-[60%] z-20 w-10 h-10 bg-[#0026ff] text-white flex items-center justify-center shadow-md hover:bg-blue-800 transition-colors opacity-0 group-hover/section:opacity-100 duration-300 cursor-pointer"
        aria-label="Previous"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
        </svg>
      </button>

      <div
        #carousel
        class="flex gap-4 overflow-x-auto scroll-smooth pb-6 scrollbar-custom snap-x snap-mandatory px-4"
      >

        @if (eventsResource.isLoading()) {
          @for (item of [1,2,3,4]; track item) {
            <div class="w-72 md:w-80 shrink-0 animate-pulse">
              <div class="w-full h-40 md:h-44 bg-gray-200 rounded-md mb-3"></div>
              <div class="h-3 bg-gray-200 w-1/3 mb-2 rounded"></div>
              <div class="h-4 bg-gray-200 w-3/4 rounded"></div>
            </div>
          }
        }

        @for (event of eventsResource.value(); track event.id) {
          <article class="w-72 md:w-80 shrink-0 snap-start group cursor-pointer" routerLink="/dentro/events/id/{{event.id}}">
            <div class="relative w-full h-40 md:h-44 overflow-hidden rounded-md mb-3 bg-gray-200">
               <img
                 [src]="event.posterUrl"
                 [alt]="event.name"
                 loading="lazy"
                 class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
               >
            </div>

            <p class="text-[11px] font-bold text-gray-500 uppercase tracking-wide mb-1 truncate">
              {{ event.gender }}
            </p>

            <h3 class="text-[15px] font-bold text-gray-900 leading-snug group-hover:underline decoration-2 underline-offset-2 pr-2 truncate">
              {{ event.name }}
            </h3>
          </article>
        }

        @if (!eventsResource.isLoading() && eventsResource.value()?.length === 0) {
           <component-loading-carousel />
        }

      </div>

      <button
        [hidden]="eventsResource.isLoading()"
        (click)="scrollRight()"
        class="absolute right-0 top-1/2 -translate-y-[60%] z-20 w-10 h-10 bg-[#0026ff] text-white flex items-center justify-center shadow-md hover:bg-blue-800 transition-colors opacity-0 group-hover/section:opacity-100 duration-300 cursor-pointer"
        aria-label="Next"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
        </svg>
      </button>

    </div>
  }
</div>
